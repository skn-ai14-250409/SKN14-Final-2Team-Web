{% extends "scentpick/base.html" %}
{% load socialaccount %}

{% block title %}로그인 - ScentPick{% endblock %}
{% block content %}
<style>
.password-toggle-btn {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
  color: #6b7280;
  padding: 0;
  display: flex;
  align-items: center;
}
.password-toggle-btn:hover {
  color: #374151;
}
</style>
<div class="auth-container">
  <h2 style="text-align:center;margin-bottom:30px;color:#2d3748;">로그인</h2>

  {% if error %}
    <div style="background-color: #fed7d7; border: 1px solid #e53e3e; color: #c53030; padding: 10px; border-radius: 5px; margin-bottom: 20px; text-align: center;">
      {{ error }}
    </div>
  {% endif %}

  <!-- 일반 로그인 폼 -->
  <form method="post">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ next|default:'' }}">
    
    <div class="form-group">
      <label>아이디</label>
      <input type="text" name="username" value="{{ form_data.username|default:'' }}" placeholder="아이디를 입력하세요" required>
    </div>
    
    <div class="form-group">
      <label>비밀번호</label>
      <div style="position: relative;">
        <input type="password" name="password" id="login-password" placeholder="비밀번호를 입력하세요" required>
        <button type="button" id="toggle-login-password" class="password-toggle-btn"></button>
      </div>
    </div>
    
    <button type="submit" class="btn-primary">로그인</button>
  </form>

  <div style="text-align:center;margin:15px 0;">
    <a style="color:#718096;text-decoration:none;font-size:14px;margin-right:15px;">아이디 찾기</a>
    <a style="color:#718096;text-decoration:none;font-size:14px;">비밀번호 찾기</a>
  </div>

  <div style="text-align:center;margin:20px 0;">
    <a href="{% url 'uauth:register' %}" style="color:#6366f1;text-decoration:none;font-weight:500;">회원가입</a>
  </div>
  
  <!-- 구분선 -->
  <div style="text-align:center;margin:30px 0;position:relative;">
    <div style="height:1px;background-color:#e2e8f0;"></div>
    <span style="background-color:white;padding:0 15px;color:#718096;position:absolute;top:-10px;left:50%;transform:translateX(-50%);">또는</span>
  </div>
  
  <!-- Social login -->
  <div class="social-login">
    <a href="/accounts/naver/login/?process=login{% if next %}&next={{ next|urlencode }}{% endif %}"
       class="social-btn brand-naver">naver</a>
    <a href="/accounts/kakao/login/?process=login{% if next %}&next={{ next|urlencode }}{% endif %}"
       class="social-btn brand-kakao">kakao</a>
    <a href="/accounts/google/login/?process=login{% if next %}&next={{ next|urlencode }}{% endif %}"
       class="social-btn brand-google">google</a>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const loginPasswordInput = document.getElementById("login-password");
  const toggleLoginPassword = document.getElementById("toggle-login-password");

  // SVG 아이콘 상수
  const ICONS = {
    EYE: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>',
    EYE_OFF: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>'
  };

  // 비밀번호 가시성 토글
  function togglePasswordVisibility(input, toggleBtn) {
    if (input.type === "password") {
      input.type = "text";
      toggleBtn.innerHTML = ICONS.EYE_OFF;
    } else {
      input.type = "password";
      toggleBtn.innerHTML = ICONS.EYE;
    }
  }

  // 비밀번호 토글 버튼 초기화
  toggleLoginPassword.innerHTML = ICONS.EYE;
  toggleLoginPassword.addEventListener('click', function() {
    togglePasswordVisibility(loginPasswordInput, toggleLoginPassword);
  });
});
</script>
{% endblock %}
